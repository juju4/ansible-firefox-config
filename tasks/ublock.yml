---
# https://github.com/gorhill/uBlock/wiki/Deploying-uBlock-Origin
# https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_manifests#manifest_location

- name: Deploy Managed storage per extension for custom settings
  loop: "{{ managed_storage_ext }}"
  loop_control:
    loop_var: item_ext
  block:
    - name: Ensure target directories exist
      ansible.builtin.file:
        path: "{{ item }}"
        state: directory
        mode: '0755'
        owner: root
      loop: "{{ managed_storage_directories }}"
    - name: Push custom settings
      ansible.builtin.template:
        src: "{{ item_ext }}.j2"
        dest: "{{ item }}/{{ item_ext }}"
        mode: '0644'
        owner: root
      loop: "{{ managed_storage_directories }}"
